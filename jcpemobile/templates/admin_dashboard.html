{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo - JC PE</title>
    <link rel="icon" type="image/png" href="{% static 'images/jc-favicon.png' %}">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f8f9fa;
            color: #212529;
        }

        .header {
            background: #ffffff;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-bottom: 1px solid #e9ecef;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-logo {
            height: 40px;
            width: auto;
        }

        .header h1 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #212529;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #495057;
            font-size: 0.9rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: transparent;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #495057;
            overflow: hidden;
        }

        .user-avatar svg {
            width: 40px;
            height: 40px;
            display: block;
        }

        .btn {
            padding: 0.5rem 1.25rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s;
            font-size: 0.875rem;
            font-weight: 500;
            text-align: center;
        }

        .btn-primary {
            background: #0d6efd;
            color: white;
        }

        .btn-primary:hover {
            background: #0b5ed7;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(13,110,253,0.3);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(16,185,129,0.3);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-secondary {
            background: #33363F;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.75rem;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
            transition: all 0.2s;
        }

        /* Removed left accent bar to keep cards uniform */

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: #33363F;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
            text-transform: none;
        }

        .stat-card p {
            font-size: 2.5rem;
            font-weight: 700;
            color: #212529;
            line-height: 1;
        }

        .content-section {
            background: white;
            border-radius: 12px;
            padding: 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
            overflow: hidden;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #e9ecef;
            background: #fafbfc;
        }

        .section-header h2 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #212529;
        }

        .noticias-table {
            width: 100%;
            border-collapse: collapse;
        }

        .noticias-table th,
        .noticias-table td {
            padding: 1.25rem 2rem;
            text-align: left;
            font-size: 0.875rem;
        }

        .noticias-table th {
            background: #fafbfc;
            font-weight: 600;
            color: #495057;
            border-bottom: 1px solid #e9ecef;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.5px;
        }

        .noticias-table td {
            border-bottom: 1px solid #f1f3f5;
        }

        .noticias-table tr:hover {
            background: #f8f9fa;
        }

        .noticias-table tr:last-child td {
            border-bottom: none;
        }

        .action-buttons {
            display: flex;
            gap: 0.08rem; /* icons even closer together */
        }

        /* Make edit/delete action buttons icon-only: remove heavy backgrounds and keep colored icons */
        .action-buttons .btn-warning,
        .action-buttons .btn-danger {
            background: transparent;
            border: none;
            padding: 0.06rem; /* reduce internal padding */
            min-width: 0; /* allow buttons to shrink to icon width */
            width: auto;
            height: 36px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            /* make SVG use the button color via currentColor */
        }

        /* nudge the edit icon slightly to the right */
        .action-buttons .btn-warning {
            margin-left: 6px;
        }

        /* Make icons black and slightly larger */
        .action-buttons .btn-warning,
        .action-buttons .btn-danger {
            color: #000; /* icon color set to black */
        }

        .action-buttons .btn-warning svg,
        .action-buttons .btn-danger svg {
            margin: 0; /* remove extra spacing around the icon */
            vertical-align: middle;
            width: 24px; /* unified larger size */
            height: 24px;
        }

        .action-buttons .btn-warning:hover {
            background: rgba(245,158,11,0.12);
        }

        .action-buttons .btn-danger:hover {
            background: rgba(239,68,68,0.12);
        }

        .action-buttons .btn {
            padding: 0.4rem 0.875rem;
            font-size: 0.8125rem;
        }

        .badge {
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .badge-categoria {
            background: #dc3545;
            color: white;
        }

        .alert {
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            border: 1px solid transparent;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-color: #a7f3d0;
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border-color: #fecaca;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #33363F;
        }

        .empty-state p {
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }

            .stats {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 1rem;
            }

            .noticias-table {
                font-size: 0.75rem;
            }

            .noticias-table th,
            .noticias-table td {
                padding: 0.75rem 1rem;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <img src="{% static 'images/logo-jc.png' %}" alt="JC PE Logo" class="header-logo">
            <h1>Painel Administrativo</h1>
        </div>
        <div class="header-right">
            <span class="user-info">
                Olá, <strong>admin</strong>
            </span>
            <div class="user-avatar" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none" aria-hidden="true">
                    <path d="M25 16.6667C25 19.4281 22.7614 21.6667 20 21.6667C17.2386 21.6667 15 19.4281 15 16.6667C15 13.9053 17.2386 11.6667 20 11.6667C22.7614 11.6667 25 13.9053 25 16.6667Z" fill="#33363F" stroke="#33363F" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="20" cy="20" r="15" stroke="#33363F" stroke-width="3"/>
                    <path d="M29.6342 31.3773C29.8461 31.261 29.9463 31.0092 29.8567 30.7847C29.214 29.1741 27.9759 27.7557 26.3024 26.7221C24.4943 25.6053 22.279 25 20 25C17.721 25 15.5057 25.6053 13.6976 26.7221C12.0241 27.7557 10.786 29.1741 10.1433 30.7847C10.0537 31.0092 10.1539 31.261 10.3658 31.3773C16.3662 34.6716 23.6338 34.6716 29.6342 31.3773Z" fill="#33363F"/>
                </svg>
            </div>
        </div>
    </div>

    <div class="container">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <div class="stats">
            <div class="stat-card">
                <h3>Total de notícias</h3>
                <p>{{ total_noticias|default:"10" }}</p>
            </div>
            <div class="stat-card">
                <h3>Categorias</h3>
                <p>{{ total_categorias|default:"8" }}</p>
            </div>
            <div class="stat-card">
                <h3>Autores</h3>
                <p>{{ total_autores|default:"12" }}</p>
            </div>
            <div class="stat-card">
                <h3>Visualizações Hoje</h3>
                <p>{{ visualizacoes_hoje|default:"20.000" }}</p>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h2>Gerenciar notícias</h2>
                <div style="display: flex; gap: 0.75rem;">
                    <a href="{% url 'index' %}" class="btn btn-secondary">Ver Site</a>
                    <a href="{% url 'admin_criar_noticia' %}" class="btn btn-success">+ Nova Notícia</a>
                </div>
            </div>

            <table class="noticias-table">
                <thead>
                    <tr>
                        <th>Título</th>
                        <th>Categorias</th>
                        <th>Autor</th>
                        <th>Data</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% if noticias %}
                        {% for noticia in noticias %}
                        <tr>
                            <td>{{ noticia.titulo|truncatewords:8 }}</td>
                            <td>
                                <span class="badge badge-categoria">
                                    {{ noticia.categoria.nome }}
                                </span>
                            </td>
                            <td>{{ noticia.autor.nome }}</td>
                            <td>{{ noticia.data_publicacao|date:"d/m/Y" }}</td>
                            <td>
                                <div class="action-buttons">
                                    <a href="{% url 'admin_editar_noticia' noticia.id %}" class="btn btn-warning" aria-label="Editar notícia">
                                        <!-- Custom edit icon adapted to site: inherits button color via currentColor -->
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 30 30" fill="currentColor" aria-hidden="true">
                                            <path d="M14.8412 10.1587C16.1167 12.168 17.8319 13.8723 19.8646 15.1353L10.8568 24.144C10.4318 24.5691 10.2185 24.7817 9.9574 24.9214C9.69645 25.0609 9.40177 25.12 8.81287 25.2378L4.48572 26.103C4.15311 26.1695 3.98658 26.2025 3.89197 26.1079C3.79748 26.0133 3.83035 25.8467 3.89685 25.5142L4.76208 21.188C4.87998 20.5985 4.93973 20.3036 5.07947 20.0425C5.2192 19.7814 5.4318 19.5691 5.85681 19.144L14.8412 10.1587ZM20.8871 4.61182C21.1269 4.56759 21.3729 4.56759 21.6127 4.61182C22.2243 4.72463 22.7333 5.23344 23.7504 6.25049C24.7671 7.2672 25.2752 7.77571 25.3881 8.38721C25.4323 8.62703 25.4323 8.87297 25.3881 9.11279C25.2752 9.72444 24.7674 10.2334 23.7504 11.2505L21.3226 13.6772C19.239 12.4786 17.5092 10.7614 16.2953 8.70459L18.7504 6.25049C19.7673 5.23352 20.2755 4.72469 20.8871 4.61182Z"/>
                                        </svg>
                                    </a>
                                    <form method="POST" action="{% url 'admin_deletar_noticia' noticia.id %}" style="display: inline;" onsubmit="return confirm('Tem certeza que deseja deletar esta notícia?');">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-danger" aria-label="Deletar notícia">
                                                <!-- Custom delete icon adapted: uses currentColor so it inherits .btn-danger color (set to black via CSS) -->
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 30 30" fill="currentColor" aria-hidden="true">
                                                    <path d="M26.25 11.4771C25.7853 11.4771 25.5526 11.4767 25.3594 11.5151C24.5663 11.673 23.946 12.2933 23.7881 13.0864C23.7497 13.2796 23.75 13.5124 23.75 13.9771V20.4771C23.75 23.3055 23.7498 24.7195 22.8711 25.5981C21.9924 26.4768 20.5784 26.4771 17.75 26.4771H12.25C9.42157 26.4771 8.00759 26.4768 7.12891 25.5981C6.25023 24.7195 6.25 23.3055 6.25 20.4771V13.9771C6.25 13.5124 6.25034 13.2796 6.21191 13.0864C6.05401 12.2933 5.43371 11.673 4.64062 11.5151C4.44743 11.4767 4.21466 11.4771 3.75 11.4771V7.72705H26.25V11.4771ZM11.875 12.9771C11.3227 12.9771 10.875 13.4248 10.875 13.9771V20.2271C10.875 20.7793 11.3227 21.2271 11.875 21.2271C12.4273 21.2271 12.875 20.7793 12.875 20.2271V13.9771C12.875 13.4248 12.4273 12.9771 11.875 12.9771ZM18.125 12.9771C17.5727 12.9771 17.125 13.4248 17.125 13.9771V20.2271C17.125 20.7793 17.5727 21.2271 18.125 21.2271C18.6773 21.2271 19.125 20.7793 19.125 20.2271V13.9771C19.125 13.4248 18.6773 12.9771 18.125 12.9771Z"/>
                                                    <path d="M12.5852 4.21324C12.7276 4.08034 13.0415 3.96291 13.4781 3.87915C13.9147 3.7954 14.4497 3.75 15 3.75C15.5503 3.75 16.0853 3.7954 16.5219 3.87915C16.9585 3.96291 17.2724 4.08034 17.4148 4.21324" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
                                                </svg>
                                        </button>
                                    </form>
                                    <a href="{% url 'noticia_detalhe' noticia.slug %}" class="btn btn-primary" target="_blank">Ver</a>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="5" class="empty-state">
                                <p>Nenhuma notícia cadastrada ainda.</p>
                                <a href="{% url 'admin_criar_noticia' %}" class="btn btn-success">Criar Primeira Notícia</a>
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>
